<!DOCTYPE html>
<html>
<head>
    <title>Registration Test</title>
        <style>
                body { font-family: sans-serif; padding: 20px; }
                        h1 { color: #333; }
                                button { 
                                            padding: 10px 20px; 
                                                        font-size: 16px; 
                                                                    cursor: pointer;
                                                                                background-color: #4CAF50;
                                                                                            color: white;
                                                                                                        border: none;
                                                                                                                    border-radius: 5px;
                                                                                                                                margin-bottom: 20px;
                                                                                                                                        }
                                                                                                                                                pre { 
                                                                                                                                                            background-color: #f4f4f4; 
                                                                                                                                                                        padding: 15px; 
                                                                                                                                                                                    border: 1px solid #ddd; 
                                                                                                                                                                                                white-space: pre-wrap;
                                                                                                                                                                                                            border-radius: 5px;
                                                                                                                                                                                                                    }
                                                                                                                                                                                                                        </style>
                                                                                                                                                                                                                        </head>
                                                                                                                                                                                                                        <body>
                                                                                                                                                                                                                            <h1>API Registration Test</h1>
                                                                                                                                                                                                                                <button onclick="registerUser()">Attempt Registration (Creates Wallet ID)</button>
                                                                                                                                                                                                                                    <pre id="output">Click the button above to start the test.</pre>

                                                                                                                                                                                                                                        <script>
                                                                                                                                                                                                                                                // *** YOUR CODESPACE URL IS NOW FIXED HERE ***
                                                                                                                                                                                                                                                        const BASE_URL = 'https://silver-adventure-q749ppv7rgx7397pr-3000.app.github.dev'; 

                                                                                                                                                                                                                                                                async function registerUser() {
                                                                                                                                                                                                                                                                            const url = `${BASE_URL}/api/users/register`;
                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                    // Generate a unique wallet_id each time to test the system
                                                                                                                                                                                                                                                                                                                const wallet_id = "test_wallet_" + Date.now().toString().slice(-4); 
                                                                                                                                                                                                                                                                                                                            const password = "securepassword";

                                                                                                                                                                                                                                                                                                                                        const outputElement = document.getElementById('output');
                                                                                                                                                                                                                                                                                                                                                    outputElement.textContent = `Sending request to: ${url}\nAttempting registration for Wallet ID: ${wallet_id} ...`;

                                                                                                                                                                                                                                                                                                                                                                try {
                                                                                                                                                                                                                                                                                                                                                                                const response = await fetch(url, {
                                                                                                                                                                                                                                                                                                                                                                                                    method: 'POST',
                                                                                                                                                                                                                                                                                                                                                                                                                        headers: {
                                                                                                                                                                                                                                                                                                                                                                                                                                                'Content-Type': 'application/json'
                                                                                                                                                                                                                                                                                                                                                                                                                                                                    },
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        body: JSON.stringify({ wallet_id, password })
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        });

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        const data = await response.json();
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        // Set color based on status code
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        if (response.status === 201) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            outputElement.style.color = 'green';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            } else if (response.status === 409) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                outputElement.style.color = 'orange'; // Conflict: Already registered
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } else {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    outputElement.style.color = 'red'; // Other errors
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    outputElement.textContent = `Status: ${response.status} (${response.statusText})\nResponse:\n${JSON.stringify(data, null, 2)}`;

                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                } catch (error) {
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                outputElement.style.color = 'red';
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                outputElement.textContent = `FATAL ERROR: Could not connect to the server. (Is 'node server.js' running?)\n\n${error}`;
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    }
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </script>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </body>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </html>